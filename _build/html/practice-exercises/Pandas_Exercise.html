
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Th·ª±c h√†nh nh·∫≠p li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau &#8212; Khoa h·ªçc d·ªØ li·ªáu trong Kinh t·∫ø v√† Kinh doanh (S·ª≠ d·ª•ng ng√¥n ng·ªØ Python)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'practice-exercises/Pandas_Exercise';</script>
    <link rel="canonical" href="https://www.tomasbeuzen.com/python-programming-for-data-science/practice-exercises/Pandas_Exercise.html" />
    <link rel="icon" href="../_static/favicon2.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu" href="50_bai_tap_tien_xu_ly_du_lieu.html" />
    <link rel="prev" title="B√†i t·∫≠p tr·ª±c quan h√≥a d·ªØ li·ªáu" href="30_bai_tap_pandas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Khoa h·ªçc d·ªØ li·ªáu trong Kinh t·∫ø v√† Kinh doanh (S·ª≠ d·ª•ng ng√¥n ng·ªØ Python) - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Khoa h·ªçc d·ªØ li·ªáu trong Kinh t·∫ø v√† Kinh doanh (S·ª≠ d·ª•ng ng√¥n ng·ªØ Python) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Khoa h·ªçc d·ªØ li·ªáu trong Kinh t·∫ø v√† Kinh doanh
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Danh s√°ch ch∆∞∆°ng</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapters/gioi-thieu-ve-khoa-hoc-du-lieu.html">1. C√°c kh√°i ni·ªám c∆° b·∫£n trong khoa h·ªçc d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/nguyen-ly-phan-tich-du-lieu.html">2. Nguy√™n l√Ω ph√¢n t√≠ch d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/khung-phuong-phap-xay-dung-mo-hinh.html">3. T·ªïng quan v·ªÅ x√¢y d·ª±ng m√¥ h√¨nh tr√™n d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter4-basics.html">4. Python c∆° b·∫£n</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter5-Numpy.html">5. Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter6-pandas.html">6. Gi·ªõi thi·ªáu v·ªÅ pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter7-Import-data.html">7. Nh·∫≠p v√† l∆∞u tr·ªØ d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter8-prepare.html">8. L√†m s·∫°ch v√† chu·∫©n b·ªã d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter9-transform.html">9. S·∫Øp x·∫øp v√† bi·∫øn ƒë·ªïi d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter10-visualization.html">10. Tr·ª±c quan h√≥a d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/chapter12-Supervised.html">11. C√°c m√¥ h√¨nh h·ªçc m√°y c√≥ gi√°m s√°t</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">B√†i t·∫≠p th·ª±c h√†nh</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="100_bai_tap_python_day_du.html">Python c∆° b·∫£n</a></li>
<li class="toctree-l1"><a class="reference internal" href="50_bai_tap_numpy.html">B√†i t·∫≠p NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="30_bai_tap_pandas.html">B√†i t·∫≠p tr·ª±c quan h√≥a d·ªØ li·ªáu</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Th·ª±c h√†nh nh·∫≠p li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau</a></li>





<li class="toctree-l1"><a class="reference internal" href="50_bai_tap_tien_xu_ly_du_lieu.html">Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="50_bai_tap_matplotlib_seaborn.html">Th·ª±c h√†nh tr·ª±c quan h√≥a d·ªØ li·ªáu</a></li>
<li class="toctree-l1"><a class="reference internal" href="50_bai_tap_linear_softmax_models.html">M√¥ h√¨nh tuy·∫øn t√≠nh</a></li>
<li class="toctree-l1"><a class="reference internal" href="50_bai_tap_cay_rung_boosting.html">C√¢y quy·∫øt ƒë·ªãnh v√† t·∫≠p h·ª£p c√¢y quy·∫øt ƒë·ªãnh</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/NCT-NEU/Python-Data-Science-Book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/practice-exercises/Pandas_Exercise.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Th·ª±c h√†nh nh·∫≠p li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Th·ª±c h√†nh nh·∫≠p li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-1-doc-file-tu-file-delimited-data">B√†i t·∫≠p 1: ƒê·ªçc file T·ª´ file delimited data:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu">üî∞ Gi·ªõi thi·ªáu:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-doc-file-delimited-data"><strong>1A.</strong> ƒê·ªçc file Delimited data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-gop-files"><strong>1B.</strong> G·ªôp files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai-bai-tap-1">L·ªùi gi·∫£i b√†i t·∫≠p 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a"><strong>1A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b"><strong>1B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-2-doc-du-lieu-tu-tu-file-excel">B√†i t·∫≠p 2: ƒê·ªçc d·ªØ li·ªáu t·ª´ T·ª´ File excel</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-3-tu-file-hoac-object-json">B√†i t·∫≠p 3: T·ª´ file ho·∫∑c object json:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#yeu-cau">Y√™u c·∫ßu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai-bai-tap-3">L·ªùi gi·∫£i b√†i t·∫≠p 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>3A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>3B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-4-lay-du-lieu-tu-api">B√†i t·∫≠p 4: L·∫•y d·ªØ li·ªáu t·ª´ API</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Y√™u c·∫ßu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-tim-api-du-lieu-bang-gia-khop-lenh-vn30"><strong>4A.</strong> T√¨m API d·ªØ li·ªáu b·∫£ng gi√° kh·ªõp l·ªánh VN30</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-tai-tao-du-lieu"><strong>4B.</strong> T√°i t·∫°o d·ªØ li·ªáu</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai">L·ªùi gi·∫£i</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>4A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>4B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-5-lay-du-lieu-tu-trang-web-khong-qua-api">B√†i t·∫≠p 5: L·∫•y d·ªØ li·ªáu t·ª´ trang web (kh√¥ng qua API)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Y√™u c·∫ßu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-khoi-tao-trinh-duyet-va-load-du-lieu"><strong>5A.</strong> Kh·ªüi t·∫°o tr√¨nh duy·ªát v√† load d·ªØ li·ªáu</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-khoi-tao-trinh-duyet-va-load-du-lieu"><strong>5B.</strong> Kh·ªüi t·∫°o tr√¨nh duy·ªát v√† load d·ªØ li·ªáu</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">L·ªùi gi·∫£i</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>5A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>5B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-6-doc-du-lieu-tu-co-so-du-lieu-sql-voi-pandas">B√†i t·∫≠p 6: ƒê·ªçc d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu SQL v·ªõi Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Y√™u c·∫ßu</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-thong-ke-doanh-thu-theo-quoc-gia"><strong>6A.</strong> Th·ªëng k√™ doanh thu theo qu·ªëc gia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-tinh-so-bai-hat-theo-tung-the-loai-genre">6B. T√≠nh s·ªë b√†i h√°t theo t·ª´ng th·ªÉ lo·∫°i (Genre)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai-bai-tap-6">L·ªùi gi·∫£i b√†i t·∫≠p 6</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><strong>6A.</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">6B</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="thuc-hanh-nhap-lieu-tu-cac-nguon-khac-nhau">
<h1>Th·ª±c h√†nh nh·∫≠p li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau<a class="headerlink" href="#thuc-hanh-nhap-lieu-tu-cac-nguon-khac-nhau" title="Link to this heading">#</a></h1>
<p>M·ª•c ti√™u chung c·ªßa ph·∫ßn n√†y l√† ƒë·ªÉ t·ªïng h·ª£p c√°c c√°ch x·ª≠ l√Ω file format kh√°c nhau, bi·∫øn th√†nh dataframe, x·ª≠ l√Ω r·ªìi xu·∫•t file d∆∞·ªõi ƒë·ªãnh d·∫°ng excel v·ªõi python. C√°c d·ªØ li·ªáu c·ªßa ch∆∞∆°ng b√†i t·∫≠p n√†y c√≥ th·ªÉ download t·ª´ link sau: <a class="reference external" href="https://drive.google.com/drive/folders/1Ckmw9z7FLnpuVBdiLorI4YgTuV3xQjeL">https://drive.google.com/drive/folders/1Ckmw9z7FLnpuVBdiLorI4YgTuV3xQjeL</a>. C√°c th∆∞ vi·ªán li√™n quan c·ªßa ph·∫ßn b√†i t·∫≠p n√†y c≈©ng ƒë∆∞·ª£c li·ªát k√™ d∆∞·ªõi ƒë√¢y:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install beautifulsoup4 pandas pandasql requests selenium sqlalchemy webdriver-manager</span>
</pre></div>
</div>
</div>
</div>
<section id="bai-tap-1-doc-file-tu-file-delimited-data">
<h2>B√†i t·∫≠p 1: ƒê·ªçc file T·ª´ file delimited data:<a class="headerlink" href="#bai-tap-1-doc-file-tu-file-delimited-data" title="Link to this heading">#</a></h2>
</section>
<section id="gioi-thieu">
<h2>üî∞ Gi·ªõi thi·ªáu:<a class="headerlink" href="#gioi-thieu" title="Link to this heading">#</a></h2>
<p>Delimited data (d·ªØ li·ªáu ph√¢n t√°ch) l√† d·∫°ng d·ªØ li·ªáu vƒÉn b·∫£n trong ƒë√≥ c√°c tr∆∞·ªùng ƒë∆∞·ª£c ngƒÉn c√°ch b·∫±ng k√Ω t·ª± ƒë·∫∑c bi·ªát nh∆∞ d·∫•u ph·∫©y (,), tab (\t), ho·∫∑c d·∫•u ch·∫•m ph·∫©y (;). C√°c ƒë·ªãnh d·∫°ng ph·ªï bi·∫øn nh·∫•t l√† CSV (Comma-Separated Values), TSV(Tab-Separated Values) ho·∫∑c trong m·ªôt v√†i tr∆∞·ªùng h·ª£p l√† txt(text-file). C√°c d·ªØ li·ªáu n√†y th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ l∆∞u tr·ªØ b·∫£ng d·ªØ li·ªáu t·ª´ Excel, c∆° s·ªü d·ªØ li·ªáu ho·∫∑c xu·∫•t t·ª´ ph·∫ßn m·ªÅm.
M·ª•c ti√™u b√†i t·∫≠p n√†y l√† gi√∫p b·∫°n ƒë·ªçc v√† x·ª≠ l√Ω d·ªØ li·ªáu t·ª´ c√°c file CSV b·∫±ng pandas ƒë·ªÉ chu·∫©n b·ªã cho ph√¢n t√≠ch d·ªØ li·ªáu.</p>
<section id="a-doc-file-delimited-data">
<h3><strong>1A.</strong> ƒê·ªçc file Delimited data<a class="headerlink" href="#a-doc-file-delimited-data" title="Link to this heading">#</a></h3>
<p>Data t·ª´ 2 file book_data.csv v√† comments.txt t·ª´ folder Data.</p>
<p>File ƒë·∫ßu ti√™n c√≥ ƒë·ªãnh d·∫°ng csv; trong khi file th·ª© 2 c√≥ ƒë·ªãnh d·∫°ng txt, ph√¢n c√°ch b·ªüi d·∫•u ;.</p>
<p>M·ª•c ti√™u thu ƒë∆∞·ª£c 2 object pd.DataFrame c√≥ ƒë·ªãnh d·∫°ng nh∆∞ sau:</p>
<p><img alt="image.png" src="practice-exercises/attachment:image.png" /></p>
<p><img alt="image-2.png" src="practice-exercises/attachment:image-2.png" /></p>
</section>
<section id="b-gop-files">
<h3><strong>1B.</strong> G·ªôp files<a class="headerlink" href="#b-gop-files" title="Link to this heading">#</a></h3>
<p>T·ªïng h·ª£p 2 l·∫°i theo product_id ƒë·ªÉ c√≥ 1 file data t·ªïng h·ª£p theo t·ª´ng s·∫£n ph·∫©m v√† t·ª´ng comment. Xu·∫•t th√†nh excel, ƒë·∫∑t t√™n l√† Book_data_full.csv</p>
</section>
</section>
<section id="loi-giai-bai-tap-1">
<h2>L·ªùi gi·∫£i b√†i t·∫≠p 1<a class="headerlink" href="#loi-giai-bai-tap-1" title="Link to this heading">#</a></h2>
<section id="a">
<h3><strong>1A.</strong><a class="headerlink" href="#a" title="Link to this heading">#</a></h3>
<p>ƒê·ªÉ ƒë·ªçc hai file d·ªØ li·ªáu d·∫°ng delimited, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng h√†m pd.read_csv trong th∆∞ vi·ªán pandas. H√†m n√†y h·ªó tr·ª£ nhi·ªÅu tham s·ªë c·∫•u h√¨nh nh∆∞ l·ª±a ch·ªçn k√Ω t·ª± ph√¢n t√°ch, m√£ h√≥a ng√¥n ng·ªØ (v√≠ d·ª•: ti·∫øng Vi·ªát, ti·∫øng Anh), v.v. ƒê·ªÉ hi·ªÉu r√µ h∆°n v·ªÅ c√°ch s·ª≠ d·ª•ng, b·∫°n c√≥ th·ªÉ tham kh·∫£o t√†i li·ªáu ch√≠nh th·ª©c t·∫°i: <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data/book_data.csv&#39;</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data/comments.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data/book_data.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data/comments.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>   <span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;Data/book_data.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>title</th>
      <th>authors</th>
      <th>original_price</th>
      <th>current_price</th>
      <th>quantity</th>
      <th>category</th>
      <th>n_review</th>
      <th>avg_rating</th>
      <th>pages</th>
      <th>manufacturer</th>
      <th>cover_link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>comment_id</th>
      <th>title</th>
      <th>thank_count</th>
      <th>customer_id</th>
      <th>rating</th>
      <th>content</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>74021317</td>
      <td>12559756</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>313</td>
      <td>22051463</td>
      <td>5</td>
      <td>C√≥ nh·ªØng ng∆∞·ªùi b∆∞·ªõc ƒë·∫øn, h·ªç l·∫•p ƒë·∫ßy h·∫°nh ph√∫c ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>74021317</td>
      <td>16979365</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>6</td>
      <td>27791831</td>
      <td>5</td>
      <td>Th·∫•y nhi·ªÅu b·∫°n ch√™ tiki g√≥i h√†ng qu√°, may sao ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="b">
<h3><strong>1B.</strong><a class="headerlink" href="#b" title="Link to this heading">#</a></h3>
<p>ƒê·ªÉ k·∫øt h·ª£p (g·ªôp) th√¥ng tin t·ª´ hai b·∫£ng d·ªØ li·ªáu d·ª±a tr√™n m·ªôt kh√≥a chung (key), b·∫°n ƒë·ªçc c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c h√†m trong th∆∞ vi·ªán pandas nh∆∞:</p>
<ul class="simple">
<li><p>pd.merge() ‚Äì linh ho·∫°t v√† ph·ªï bi·∫øn nh·∫•t, cho ph√©p g·ªôp theo m·ªôt ho·∫∑c nhi·ªÅu c·ªôt kh√≥a, v·ªõi nhi·ªÅu ki·ªÉu g·ªôp nh∆∞ inner, left, right, outer</p></li>
<li><p>DataFrame.join() ‚Äì th∆∞·ªùng d√πng khi g·ªôp theo ch·ªâ s·ªë (index) ho·∫∑c khi ch·ªâ c·∫ßn n·ªëi ƒë∆°n gi·∫£n hai b·∫£ng</p></li>
<li><p>pd.concat() ‚Äì s·ª≠ d·ª•ng khi mu·ªën g·ªôp d·ªØ li·ªáu theo chi·ªÅu d·ªçc ho·∫∑c ngang m√† kh√¥ng c·∫ßn ch·ªâ r√µ kh√≥a</p></li>
</ul>
<p>L∆∞u √Ω: v·ªõi c√°c ph∆∞∆°ng ph√°p n√†y, b·∫°n c·∫ßn ch·ªâ ƒë·ªãnh r√µ c·ªôt kh√≥a (key) ‚Äì t·ª©c l√† th√¥ng tin chung gi·ªØa hai b·∫£ng ‚Äì ƒë·ªÉ qu√° tr√¨nh gh√©p d·ªØ li·ªáu ƒë∆∞·ª£c th·ª±c hi·ªán ch√≠nh x√°c.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;product_id&#39;</span><span class="p">)</span>
<span class="n">merged_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>title_x</th>
      <th>authors</th>
      <th>original_price</th>
      <th>current_price</th>
      <th>quantity</th>
      <th>category</th>
      <th>n_review</th>
      <th>avg_rating</th>
      <th>pages</th>
      <th>manufacturer</th>
      <th>cover_link</th>
      <th>comment_id</th>
      <th>title_y</th>
      <th>thank_count</th>
      <th>customer_id</th>
      <th>rating</th>
      <th>content</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
      <td>12559756.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>313.0</td>
      <td>22051463.0</td>
      <td>5.0</td>
      <td>C√≥ nh·ªØng ng∆∞·ªùi b∆∞·ªõc ƒë·∫øn, h·ªç l·∫•p ƒë·∫ßy h·∫°nh ph√∫c ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
      <td>16979365.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>6.0</td>
      <td>27791831.0</td>
      <td>5.0</td>
      <td>Th·∫•y nhi·ªÅu b·∫°n ch√™ tiki g√≥i h√†ng qu√°, may sao ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
      <td>14069617.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>25.0</td>
      <td>17748750.0</td>
      <td>5.0</td>
      <td>B√¨a c·ª±c xinh, tiki giao h√†ng nhanh, s√°ch kh√¥ng...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
      <td>8569824.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>57.0</td>
      <td>410797.0</td>
      <td>5.0</td>
      <td>S√°ch l√∫c nh·∫≠n h√¨nh th·ª©c r·∫•t ·ªïn, kh√¥ng cong v√™n...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>74021317</td>
      <td>C√¢y Cam Ng·ªçt C·ªßa T√¥i</td>
      <td>Jos√© Mauro de Vasconcelos</td>
      <td>108000</td>
      <td>64800</td>
      <td>53075.0</td>
      <td>Ti·ªÉu Thuy·∫øt</td>
      <td>11481</td>
      <td>5.0</td>
      <td>244</td>
      <td>Nh√† Xu·∫•t B·∫£n H·ªôi Nh√† VƒÉn</td>
      <td>https://salt.tikicdn.com/ts/product/5e/18/24/2...</td>
      <td>18368714.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>0.0</td>
      <td>28545286.0</td>
      <td>5.0</td>
      <td>M·ªôt cu·ªën s√°ch r·∫•t ƒë√°ng ƒë·ªçc v·ªÅ t√¨nh y√™u th∆∞∆°ng ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>128765</th>
      <td>58971672</td>
      <td>The Best of Chicken Soup - Tuy·ªÉn T·∫≠p Nh·ªØng C√¢u...</td>
      <td>Jack Canfield</td>
      <td>138000</td>
      <td>91000</td>
      <td>954.0</td>
      <td>S√°ch ngh·ªá thu·∫≠t s·ªëng ƒë·∫πp</td>
      <td>176</td>
      <td>5.0</td>
      <td>256</td>
      <td>Nh√† Xu·∫•t B·∫£n T·ªïng h·ª£p TP.HCM</td>
      <td>https://salt.tikicdn.com/media/catalog/product...</td>
      <td>16391630.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>0.0</td>
      <td>6625296.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>128766</th>
      <td>58971672</td>
      <td>The Best of Chicken Soup - Tuy·ªÉn T·∫≠p Nh·ªØng C√¢u...</td>
      <td>Jack Canfield</td>
      <td>138000</td>
      <td>91000</td>
      <td>954.0</td>
      <td>S√°ch ngh·ªá thu·∫≠t s·ªëng ƒë·∫πp</td>
      <td>176</td>
      <td>5.0</td>
      <td>256</td>
      <td>Nh√† Xu·∫•t B·∫£n T·ªïng h·ª£p TP.HCM</td>
      <td>https://salt.tikicdn.com/media/catalog/product...</td>
      <td>12767000.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>0.0</td>
      <td>16435374.0</td>
      <td>5.0</td>
      <td>Tuy·ªát v·ªùi l·∫Øm</td>
    </tr>
    <tr>
      <th>128767</th>
      <td>58971672</td>
      <td>The Best of Chicken Soup - Tuy·ªÉn T·∫≠p Nh·ªØng C√¢u...</td>
      <td>Jack Canfield</td>
      <td>138000</td>
      <td>91000</td>
      <td>954.0</td>
      <td>S√°ch ngh·ªá thu·∫≠t s·ªëng ƒë·∫πp</td>
      <td>176</td>
      <td>5.0</td>
      <td>256</td>
      <td>Nh√† Xu·∫•t B·∫£n T·ªïng h·ª£p TP.HCM</td>
      <td>https://salt.tikicdn.com/media/catalog/product...</td>
      <td>16322348.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>0.0</td>
      <td>10549708.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>128768</th>
      <td>58971672</td>
      <td>The Best of Chicken Soup - Tuy·ªÉn T·∫≠p Nh·ªØng C√¢u...</td>
      <td>Jack Canfield</td>
      <td>138000</td>
      <td>91000</td>
      <td>954.0</td>
      <td>S√°ch ngh·ªá thu·∫≠t s·ªëng ƒë·∫πp</td>
      <td>176</td>
      <td>5.0</td>
      <td>256</td>
      <td>Nh√† Xu·∫•t B·∫£n T·ªïng h·ª£p TP.HCM</td>
      <td>https://salt.tikicdn.com/media/catalog/product...</td>
      <td>16288080.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>0.0</td>
      <td>14487833.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>128769</th>
      <td>58971672</td>
      <td>The Best of Chicken Soup - Tuy·ªÉn T·∫≠p Nh·ªØng C√¢u...</td>
      <td>Jack Canfield</td>
      <td>138000</td>
      <td>91000</td>
      <td>954.0</td>
      <td>S√°ch ngh·ªá thu·∫≠t s·ªëng ƒë·∫πp</td>
      <td>176</td>
      <td>5.0</td>
      <td>256</td>
      <td>Nh√† Xu·∫•t B·∫£n T·ªïng h·ª£p TP.HCM</td>
      <td>https://salt.tikicdn.com/media/catalog/product...</td>
      <td>16204880.0</td>
      <td>C·ª±c k√¨ h√†i l√≤ng</td>
      <td>0.0</td>
      <td>27440114.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>128770 rows √ó 18 columns</p>
</div></div></div>
</div>
<p>ƒê·ªÉ l∆∞u d·ªØ li·ªáu th√†nh file csv, m·ªôt trong nh·ªØng c√°ch ph·ªï bi·∫øn nh·∫•t l√† s·ª≠ d·ª•ng ph∆∞∆°ng th·ª©c .to_csv() c·ªßa ƒë·ªëi t∆∞·ª£ng DataFrame trong pandas. Ph∆∞∆°ng th·ª©c n√†y c√≥ th·ªÉ s·ª≠ d·ª•ng k√®m v·ªõi th∆∞ vi·ªán openpyxl ƒë·ªÉ h·ªó tr·ª£ ghi file .csv:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install openpyxl</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;Book_data_full.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bai-tap-2-doc-du-lieu-tu-tu-file-excel">
<h1>B√†i t·∫≠p 2: ƒê·ªçc d·ªØ li·ªáu t·ª´ T·ª´ File excel<a class="headerlink" href="#bai-tap-2-doc-du-lieu-tu-tu-file-excel" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bai-tap-3-tu-file-hoac-object-json">
<h1>B√†i t·∫≠p 3: T·ª´ file ho·∫∑c object json:<a class="headerlink" href="#bai-tap-3-tu-file-hoac-object-json" title="Link to this heading">#</a></h1>
<section id="id1">
<h2>üî∞ Gi·ªõi thi·ªáu:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>JSON (JavaScript Object Notation) l√† ƒë·ªãnh d·∫°ng vƒÉn b·∫£n ph·ªï bi·∫øn d√πng ƒë·ªÉ l∆∞u tr·ªØ v√† trao ƒë·ªïi d·ªØ li·ªáu,
ƒë·∫∑c bi·ªát trong c√°c ·ª©ng d·ª•ng web v√† API. JSON c√≥ c·∫•u tr√∫c g·∫ßn gi·ªëng v·ªõi dict v√† list trong Python.
M·ª•c ti√™u b√†i t·∫≠p n√†y l√† gi√∫p b·∫°n ƒë·ªçc, x·ª≠ l√Ω v√† chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu JSON (bao g·ªìm c·∫£ l·ªìng nhau) sang d·∫°ng b·∫£ng pandas ƒë·ªÉ d·ªÖ ph√¢n t√≠ch.</p>
</section>
<section id="yeu-cau">
<h2>Y√™u c·∫ßu:<a class="headerlink" href="#yeu-cau" title="Link to this heading">#</a></h2>
<p>Cho json_string_basic v√† json_string_nested v·ªõi c√πng th√¥ng tin nh∆∞ b√™n d∆∞·ªõi. L∆∞u √Ω r·∫±ng 2 string n√†y mang c√πng 1 th√¥ng tin, B·∫°n ƒë·ªçc h√£y bi·∫øn 2 string n√†y th√†nh pd.DataFrame nh∆∞ sau:</p>
<p><img alt="image.png" src="practice-exercises/attachment:image.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">json_string_basic</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">[</span>
<span class="s1">    {</span>
<span class="s1">        &quot;name&quot;: &quot;An&quot;,</span>
<span class="s1">        &quot;age&quot;: 20,</span>
<span class="s1">        &quot;major&quot;: &quot;Kinh t·∫ø&quot;,</span>
<span class="s1">        &quot;subject&quot;: &quot;To√°n&quot;,</span>
<span class="s1">        &quot;score&quot;: 9.0</span>
<span class="s1">    },</span>
<span class="s1">    {</span>
<span class="s1">        &quot;name&quot;: &quot;An&quot;,</span>
<span class="s1">        &quot;age&quot;: 20,</span>
<span class="s1">        &quot;major&quot;: &quot;Kinh t·∫ø&quot;,</span>
<span class="s1">        &quot;subject&quot;: &quot;VƒÉn&quot;,</span>
<span class="s1">        &quot;score&quot;: 8.5</span>
<span class="s1">    },</span>
<span class="s1">    {</span>
<span class="s1">        &quot;name&quot;: &quot;B√¨nh&quot;,</span>
<span class="s1">        &quot;age&quot;: 21,</span>
<span class="s1">        &quot;major&quot;: &quot;T√†i ch√≠nh&quot;,</span>
<span class="s1">        &quot;subject&quot;: &quot;To√°n&quot;,</span>
<span class="s1">        &quot;score&quot;: 7.5</span>
<span class="s1">    },</span>
<span class="s1">    {</span>
<span class="s1">        &quot;name&quot;: &quot;B√¨nh&quot;,</span>
<span class="s1">        &quot;age&quot;: 21,</span>
<span class="s1">        &quot;major&quot;: &quot;T√†i ch√≠nh&quot;,</span>
<span class="s1">        &quot;subject&quot;: &quot;VƒÉn&quot;,</span>
<span class="s1">        &quot;score&quot;: 9.0</span>
<span class="s1">    }</span>
<span class="s1">]</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">json_string_nested</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">[</span>
<span class="s1">    {</span>
<span class="s1">        &quot;name&quot;: &quot;An&quot;,</span>
<span class="s1">        &quot;age&quot;: 20,</span>
<span class="s1">        &quot;major&quot;: &quot;Kinh t·∫ø&quot;,</span>
<span class="s1">        &quot;scores&quot;: [</span>
<span class="s1">            {&quot;subject&quot;: &quot;To√°n&quot;, &quot;score&quot;: 9.0},</span>
<span class="s1">            {&quot;subject&quot;: &quot;VƒÉn&quot;, &quot;score&quot;: 8.5}</span>
<span class="s1">        ]</span>
<span class="s1">    },</span>
<span class="s1">    {</span>
<span class="s1">        &quot;name&quot;: &quot;B√¨nh&quot;,</span>
<span class="s1">        &quot;age&quot;: 21,</span>
<span class="s1">        &quot;major&quot;: &quot;T√†i ch√≠nh&quot;,</span>
<span class="s1">        &quot;scores&quot;: [</span>
<span class="s1">            {&quot;subject&quot;: &quot;To√°n&quot;, &quot;score&quot;: 7.5},</span>
<span class="s1">            {&quot;subject&quot;: &quot;VƒÉn&quot;, &quot;score&quot;: 9.0}</span>
<span class="s1">        ]</span>
<span class="s1">    }</span>
<span class="s1">]</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="loi-giai-bai-tap-3">
<h2>L·ªùi gi·∫£i b√†i t·∫≠p 3<a class="headerlink" href="#loi-giai-bai-tap-3" title="Link to this heading">#</a></h2>
<section id="id2">
<h3><strong>3A.</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>V√¨ json_string_basic l√† chu·ªói ch·ª©a m·ªôt danh s√°ch c√°c t·ª´ ƒëi·ªÉn (list of dict), n√™n ta c√≥ th·ªÉ d·ªÖ d√†ng chuy·ªÉn ƒë·ªïi th√†nh DataFrame, v·ªõi m·ªói t·ª´ ƒëi·ªÉn t∆∞∆°ng ·ª©ng v·ªõi m·ªôt d√≤ng d·ªØ li·ªáu.
ƒê√¢y l√† ph∆∞∆°ng ph√°p ƒë∆°n gi·∫£n v√† tr·ª±c ti·∫øp nh·∫•t trong tr∆∞·ªùng h·ª£p d·ªØ li·ªáu d·∫°ng ph·∫≥ng (flat). B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng h√†m json.loads ƒë·ªÉ chuy·ªÉn chu·ªói JSON th√†nh ƒë·ªëi t∆∞·ª£ng Python (dict), sau ƒë√≥ d√πng pandas.DataFrame ƒë·ªÉ t·∫°o b·∫£ng.
ƒê·ªÉ hi·ªÉu r√µ h∆°n v·ªÅ c√°ch l√†m vi·ªác v·ªõi JSON trong Python, b·∫°n c√≥ th·ªÉ tham kh·∫£o th√™m t·∫°i t√†i li·ªáu ch√≠nh th·ª©c: <a class="reference external" href="https://docs.python.org/3/library/json.html">https://docs.python.org/3/library/json.html</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parse chu·ªói JSON basic</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">json_normalize</span>
<span class="n">data_basic</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_string_basic</span><span class="p">)</span>

<span class="c1"># Chuy·ªÉn th√†nh DataFrame tr·ª±c ti·∫øp</span>
<span class="n">df_basic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_basic</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üìÑ B·∫£ng t·ª´ JSON d·∫°ng basic:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_basic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üìÑ B·∫£ng t·ª´ JSON d·∫°ng basic:
   name  age      major subject  score
0    An   20    Kinh t·∫ø    To√°n    9.0
1    An   20    Kinh t·∫ø     VƒÉn    8.5
2  B√¨nh   21  T√†i ch√≠nh    To√°n    7.5
3  B√¨nh   21  T√†i ch√≠nh     VƒÉn    9.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3><strong>3B.</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>∆∞∆°ng t·ª± nh∆∞ v·ªõi danh s√°ch c√°c dict ho·∫∑c dict of dicts, ch√∫ng ta th∆∞·ªùng g·∫∑p ph·∫£i d·ªØ li·ªáu JSON c√≥ c·∫•u tr√∫c l·ªìng nhau ‚Äì g·ªçi l√† nested JSON. Trong json_string_nested, m·ªói ph·∫ßn t·ª≠ ƒë·∫°i di·ªán cho m·ªôt sinh vi√™n, v√† b√™n trong ch·ª©a danh s√°ch ƒëi·ªÉm (scores), t·ª©c l√† c√≥ c·∫•u tr√∫c l·ªìng.</p>
<p>Trong tr∆∞·ªùng h·ª£p n√†y, tuy v·∫´n c√≥ th·ªÉ chuy·ªÉn chu·ªói JSON th√†nh dict, nh∆∞ng ta kh√¥ng th·ªÉ tr·ª±c ti·∫øp bi·∫øn ƒë·ªïi n√≥ th√†nh DataFrame nh∆∞ v·ªõi d·ªØ li·ªáu ph·∫≥ng.</p>
<p>ƒê·ªÉ x·ª≠ l√Ω, b·∫°n ƒë·ªçc c√≥ th·ªÉ :</p>
<ul class="simple">
<li><p>D√πng h√†m json_normalize() ‚Äì m·ªôt c√¥ng c·ª• m·∫°nh m·∫Ω gi√∫p ‚Äúl√†m ph·∫≥ng‚Äù c·∫•u tr√∫c JSON</p></li>
<li><p>Ch·ªâ r√µ ph·∫ßn l·ªìng (v√≠ d·ª•: scores) th√¥ng qua record_path.</p></li>
<li><p>Gi·ªØ l·∫°i c√°c tr∆∞·ªùng ngo√†i (student_id, name,‚Ä¶) qua meta.</p></li>
</ul>
<p>C√°ch n√†y r·∫•t h·ªØu √≠ch khi l√†m vi·ªác v·ªõi d·ªØ li·ªáu t·ª´ API, MongoDB ho·∫∑c c√°c file .json c√≥ nhi·ªÅu l·ªõp ph·ª©c t·∫°p. N√≥ gi√∫p tr√°nh ph·∫£i vi·∫øt v√≤ng l·∫∑p th·ªß c√¥ng, tƒÉng hi·ªáu su·∫•t x·ª≠ l√Ω, v√† linh ho·∫°t m·ªü r·ªông n·∫øu d·ªØ li·ªáu c√≥ th√™m c·∫•p l·ªìng kh√°c trong t∆∞∆°ng lai.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parse chu·ªói JSON nested</span>
<span class="n">data_nested</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_string_nested</span><span class="p">)</span>

<span class="c1"># L√†m ph·∫≥ng ph·∫ßn &#39;scores&#39; b√™n trong m·ªói sinh vi√™n</span>
<span class="n">df_nested</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span>
    <span class="n">data_nested</span><span class="p">,</span>
    <span class="n">record_path</span><span class="o">=</span><span class="s1">&#39;scores&#39;</span><span class="p">,</span>
    <span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;major&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">df_nested</span> <span class="o">=</span> <span class="n">df_nested</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üå≤ B·∫£ng t·ª´ JSON d·∫°ng nested:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_nested</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üå≤ B·∫£ng t·ª´ JSON d·∫°ng nested:
   name age      major subject  score
0    An  20    Kinh t·∫ø    To√°n    9.0
1    An  20    Kinh t·∫ø     VƒÉn    8.5
2  B√¨nh  21  T√†i ch√≠nh    To√°n    7.5
3  B√¨nh  21  T√†i ch√≠nh     VƒÉn    9.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bai-tap-4-lay-du-lieu-tu-api">
<h1>B√†i t·∫≠p 4: L·∫•y d·ªØ li·ªáu t·ª´ API<a class="headerlink" href="#bai-tap-4-lay-du-lieu-tu-api" title="Link to this heading">#</a></h1>
<section id="id4">
<h2>üî∞ Gi·ªõi thi·ªáu:<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>API (Application Programming Interface) l√† giao di·ªán l·∫≠p tr√¨nh ·ª©ng d·ª•ng ‚Äì cho ph√©p c√°c h·ªá th·ªëng ph·∫ßn m·ªÅm trao ƒë·ªïi d·ªØ li·ªáu v·ªõi nhau m·ªôt c√°ch c√≥ c·∫•u tr√∫c. Trong lƒ©nh v·ª±c web, API th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ trao ƒë·ªïi d·ªØ li·ªáu gi·ªØa tr√¨nh duy·ªát (frontend) v√† m√°y ch·ªß (backend).</p>
<p>ƒê·ªÉ quan s√°t d·ªØ li·ªáu ƒë∆∞·ª£c trao ƒë·ªïi qua API, b·∫°n c√≥ th·ªÉ m·ªü c√¥ng c·ª• DevTools (F12) ‚Üí ch·ªçn tab ‚ÄúNetwork‚Äù, sau ƒë√≥ refresh l·∫°i trang web.T·∫°i ƒë√¢y, trong m·ª•c ‚ÄúFetch‚Äù ho·∫∑c ‚ÄúXHR‚Äù, b·∫°n s·∫Ω th·∫•y danh s√°ch c√°c request m√† trang web g·ª≠i ƒëi ‚Äì ƒëa ph·∫ßn l√† c√°c API.</p>
<p>Trong v√≠ d·ª• n√†y, ch√∫ng ta s·∫Ω t√¨m hi·ªÉu b·∫£ng gi√° ch·ª©ng kho√°n c·ªßa C√¥ng ty C·ªï ph·∫ßn Ch·ª©ng kho√°n VPS th√¥ng qua API. ƒê√¢y l√† m·ªôt trong nh·ªØng ·ª©ng d·ª•ng ph·ªï bi·∫øn nh·∫•t c·ªßa API ‚Äì cung c·∫•p d·ªØ li·ªáu ƒë·ªông cho trang web v√† cho ph√©p b√™n th·ª© ba (nh∆∞ b·∫°n) truy c·∫≠p ƒë∆∞·ª£c th√¥ng tin ƒë√≥.</p>
<p>B·∫°n ƒë·ªçc c≈©ng n√™n L∆∞u √Ω r·∫±ng:</p>
<ul class="simple">
<li><p>Kh√¥ng ph·∫£i trang web n√†o c≈©ng ‚Äúm·ªü‚Äù API ra ngo√†i. Nhi·ªÅu trang ƒë√£ ·∫©n API, m√£ h√≥a request, ho·∫∑c y√™u c·∫ßu token x√°c th·ª±c.</p></li>
<li><p>Ngo√†i API, c√≤n c√≥ nh·ªØng c√°ch kh√°c ƒë·ªÉ l·∫•y d·ªØ li·ªáu nh∆∞: ƒë·ªçc HTML (web scraping), t·∫£i file Excel/CSV tr·ª±c ti·∫øp, ho·∫∑c d√πng th∆∞ vi·ªán chuy√™n d·ª•ng n·∫øu c√≥.</p></li>
</ul>
<p>M·ª•c ti√™u b√†i t·∫≠p n√†y l√† gi√∫p b·∫°n l√†m quen v·ªõi t∆∞ duy: x√°c ƒë·ªãnh API ‚Üí g·ª≠i request ‚Üí nh·∫≠n d·ªØ li·ªáu JSON ‚Üí x·ª≠ l√Ω v·ªõi pandas.</p>
</section>
<section id="id5">
<h2>Y√™u c·∫ßu<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<section id="a-tim-api-du-lieu-bang-gia-khop-lenh-vn30">
<h3><strong>4A.</strong> T√¨m API d·ªØ li·ªáu b·∫£ng gi√° kh·ªõp l·ªánh VN30<a class="headerlink" href="#a-tim-api-du-lieu-bang-gia-khop-lenh-vn30" title="Link to this heading">#</a></h3>
<p>H√£y truy c·∫≠p v√†o trang <a class="reference external" href="https://banggia.vps.com.vn/chung-khoan/VN30">https://banggia.vps.com.vn/chung-khoan/VN30</a> ƒë·ªÉ quan s√°t b·∫£ng gi√° ch·ª©ng kho√°n m·ªõi nh·∫•t c·ªßa c√°c c·ªï phi·∫øu trong r·ªï VN30.
S·ª≠ d·ª•ng c√¥ng c·ª• d√†nh cho nh√† ph√°t tri·ªÉn (DevTools ‚Äì nh·∫•n F12), chuy·ªÉn sang tab Network, sau ƒë√≥ refresh l·∫°i trang ƒë·ªÉ theo d√µi c√°c y√™u c·∫ßu ƒë∆∞·ª£c g·ª≠i t·ª´ tr√¨nh duy·ªát.
Nhi·ªám v·ª• c·ªßa b·∫°n l√† t√¨m ra ƒë∆∞·ªùng d·∫´n API tr·∫£ v·ªÅ d·ªØ li·ªáu b·∫£ng gi√° hi·ªÉn th·ªã trong h√¨nh.</p>
<p><img alt="image.png" src="practice-exercises/attachment:image.png" /></p>
</section>
<section id="b-tai-tao-du-lieu">
<h3><strong>4B.</strong> T√°i t·∫°o d·ªØ li·ªáu<a class="headerlink" href="#b-tai-tao-du-lieu" title="Link to this heading">#</a></h3>
<p>T·ª´ ƒë∆∞·ªùng d·∫´n API b·∫°n ƒë√£ t√¨m ƒë∆∞·ª£c, h√£y ƒë·ªëi chi·∫øu d·ªØ li·ªáu JSON tr·∫£ v·ªÅ v·ªõi b·∫£ng gi√° hi·ªÉn th·ªã tr√™n trang web ƒë·ªÉ x√°c nh·∫≠n ƒë·ªô ch√≠nh x√°c.
Sau ƒë√≥, tr√≠ch xu·∫•t c√°c tr∆∞·ªùng d·ªØ li·ªáu t∆∞∆°ng ·ª©ng (v√≠ d·ª•: m√£ c·ªï phi·∫øu, gi√° kh·ªõp, kh·ªëi l∆∞·ª£ng, gi√° tr·∫ßn/s√†n‚Ä¶) v√† chuy·ªÉn ƒë·ªïi th√†nh m·ªôt DataFrame ƒë·ªÉ thu·∫≠n ti·ªán cho vi·ªác ph√¢n t√≠ch v√† x·ª≠ l√Ω trong Python.</p>
</section>
</section>
<section id="loi-giai">
<h2>L·ªùi gi·∫£i<a class="headerlink" href="#loi-giai" title="Link to this heading">#</a></h2>
<section id="id6">
<h3><strong>4A.</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>B·∫°n c√≥ th·ªÉ t√¨m th·∫•y ƒë∆∞·ªùng d·∫´n API ch·ª©a d·ªØ li·ªáu b·∫£ng gi√° b·∫±ng c√°ch m·ªü tab Network nh∆∞ h√¨nh minh h·ªça.
T·∫°i ƒë√¢y, h√£y nh·∫•n chu·ªôt ph·∫£i v√†o d√≤ng t∆∞∆°ng ·ª©ng v√† ch·ªçn ‚ÄúCopy link address‚Äù ƒë·ªÉ l·∫•y URL API:
<a class="reference external" href="https://bgapidatafeed.vps.com.vn/getliststockdata/ACB,BCM,BID,BVH,">https://bgapidatafeed.vps.com.vn/getliststockdata/ACB,BCM,BID,BVH,</a>‚Ä¶,VRE
ƒê√¢y ch√≠nh l√† ƒë·ªãa ch·ªâ tr·∫£ v·ªÅ d·ªØ li·ªáu JSON c·ªßa to√†n b·ªô c·ªï phi·∫øu trong r·ªï VN30.</p>
<p><img alt="image.png" src="practice-exercises/attachment:image.png" /></p>
</section>
<section id="id7">
<h3><strong>4B.</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>Sau khi truy c·∫≠p ƒë∆∞·ª£c v√†o URL API, b·∫°n s·∫Ω th·∫•y d·ªØ li·ªáu tr·∫£ v·ªÅ ·ªü d·∫°ng <strong>JSON</strong> v·ªõi nhi·ªÅu tr∆∞·ªùng th√¥ng tin h∆°n so v·ªõi b·∫£ng hi·ªÉn th·ªã tr√™n website.
C√°c tr∆∞·ªùng d·ªØ li·ªáu c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c ƒë·∫∑t t√™n kh√°c (v√≠ d·ª•: <code class="docutils literal notranslate"><span class="pre">&quot;sym&quot;</span></code> cho m√£ c·ªï phi·∫øu, <code class="docutils literal notranslate"><span class="pre">&quot;r&quot;</span></code> cho gi√° tham chi·∫øu‚Ä¶).
ƒê·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu n√†y, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng th∆∞ vi·ªán <code class="docutils literal notranslate"><span class="pre">requests</span></code> ƒë·ªÉ g·ª≠i l·ªánh <code class="docutils literal notranslate"><span class="pre">GET</span></code>, nh·∫≠n JSON th√¥, v√† sau ƒë√≥ chuy·ªÉn th√†nh <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> ƒë·ªÉ d·ªÖ d√†ng ph√¢n t√≠ch v√† thao t√°c trong Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># G·ª≠i y√™u c·∫ßu t·ªõi API</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://bgapidatafeed.vps.com.vn/getliststockdata/ACB,BCM,BID,BVH,CTG,FPT,GAS,GVR,HDB,HPG,LPB,MBB,MSN,MWG,PLX,SAB,SHB,SSB,SSI,STB,TCB,TPB,VCB,VHM,VIB,VIC,VJC,VNM,VPB,VRE&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="c1"># response.json() ƒë√£ tr·∫£ l·∫°i object d∆∞·ªõi d·∫°ng list c√°c dictionary</span>

<span class="c1"># L·∫•y c√°c c·ªôt c·∫ßn thi·∫øt</span>
<span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">record</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;M√£ CK&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;sym&quot;</span><span class="p">],</span>
        <span class="s2">&quot;TC&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Tr·∫ßn&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">],</span>
        <span class="s2">&quot;S√†n&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Gi√° kh·ªõp&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;lastPrice&quot;</span><span class="p">],</span>
        <span class="s2">&quot;KL kh·ªõp&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;lastVolume&quot;</span><span class="p">],</span>
        <span class="s2">&quot;T·ªïng KL&quot;</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;lot&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Gi√° 3 Mua&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;g3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;g3&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;KL 3 Mua&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;g3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;g3&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;Gi√° 3 B√°n&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;g6&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;g6&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;KL 3 B√°n&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;g6&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;g6&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;+/-&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;ot&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;ot&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">}</span>
    <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

<span class="c1"># Chuy·ªÉn th√†nh DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>

<span class="c1"># Hi·ªÉn th·ªã k·∫øt qu·∫£</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üìä B·∫£ng gi√° ch·ª©ng kho√°n VN30 (VPS):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üìä B·∫£ng gi√° ch·ª©ng kho√°n VN30 (VPS):
   M√£ CK      TC    Tr·∫ßn     S√†n  Gi√° kh·ªõp  KL kh·ªõp  T·ªïng KL  Gi√° 3 Mua  \
0    ACB   21.30   22.75   19.85     21.45      100  1575260      21.35   
1    BCM   59.00   63.10   54.90     58.60       90    34100      58.40   
2    BID   35.80   38.30   33.30     36.00       30   598230      35.85   
3    BVH   51.30   54.80   47.75     50.60      360    52180      50.40   
4    CTG   40.70   43.50   37.90     41.30       30  1244920      41.20   
5    FPT  116.00  124.10  107.90    116.10       10   433940     115.80   
6    GAS   71.80   76.80   66.80     69.50       80   174190      69.30   
7    GVR   29.90   31.95   27.85     29.20       80   230610      29.10   
8    HDB   22.00   23.50   20.50     22.15       20  1533990      22.00   
9    HPG   26.90   28.75   25.05     27.00       40  2341640      26.90   
10   LPB   32.40   34.65   30.15     31.90       40   205510      31.80   
11   MBB   25.10   26.85   23.35     25.80      500  5115110      25.65   
12   MSN   67.50   72.20   62.80     67.50      480   600510      67.20   
13   MWG   64.00   68.40   59.60     64.10      700   481420      63.80   
14   PLX   39.55   42.30   36.80     39.15       10   143480      38.95   
15   SAB   49.45   52.90   46.00     49.50       20    71660      49.35   
16   SHB   13.00   13.90   12.10     13.10       10  5950270      12.95   
17   SSB   18.10   19.35   16.85     18.15       10   257650      18.00   
18   SSI   23.90   25.55   22.25     24.00       20  2508620      23.85   
19   STB   47.15   50.40   43.85     46.60      100  1092150      46.50   
20   TCB   34.00   36.35   31.65     34.00      130  1710600      33.90   
21   TPB   13.40   14.30   12.50     13.35      250   695230      13.25   
22   VCB   56.60   60.50   52.70     57.10       10   688650      56.80   
23   VHM   71.70   76.70   66.70     70.20       20   892500      70.00   
24   VIB   18.00   19.25   16.75     18.10     2000   566200      17.95   
25   VIC   89.40   95.60   83.20     86.80       10  1361530      86.60   
26   VJC   88.50   94.60   82.40     88.70       10    69760      88.40   
27   VNM   56.10   60.00   52.20     56.60       10   466140      56.20   
28   VPB   18.50   19.75   17.25     18.45      500  2490140      18.35   
29   VRE   24.70   26.40   23.00     24.60       50   383530      24.35   

    KL 3 Mua  Gi√° 3 B√°n  KL 3 B√°n   +/-  
0      16490      21.60     55490  0.15  
1       1790      59.00       420  0.40  
2       5840      36.10     11950  0.20  
3       2240      51.50       340  0.70  
4      19360      41.45     13660  0.60  
5      18350     116.30      1560  0.10  
6       5460      69.80      1300  2.30  
7       8560      29.35      4910  0.70  
8     191840      22.25     32390  0.15  
9     100400      27.15     59240  0.10  
10     22750      32.05       300  0.50  
11     91930      25.90     54030  0.70  
12      1100      67.70     10050  0.00  
13       480      64.30      3080  0.10  
14      1150      39.25       130  0.40  
15      2590      49.60      3510  0.05  
16    289410      13.20    273020  0.10  
17      5920      18.25      3340  0.05  
18     43750      24.10     73210  0.10  
19      7010      46.75      2280  0.55  
20     24790      34.15     11120  0.00  
21     46620      13.50    123890  0.05  
22        60      57.30     73900  0.50  
23     92490      71.10        30  1.50  
24     35640      18.20     60030  0.10  
25     10290      87.30        30  2.60  
26       200      88.90      2000  0.20  
27        10      56.80     44100  0.50  
28     55680      18.60     31420  0.05  
29       470      24.70     19930  0.10  
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bai-tap-5-lay-du-lieu-tu-trang-web-khong-qua-api">
<h1>B√†i t·∫≠p 5: L·∫•y d·ªØ li·ªáu t·ª´ trang web (kh√¥ng qua API)<a class="headerlink" href="#bai-tap-5-lay-du-lieu-tu-trang-web-khong-qua-api" title="Link to this heading">#</a></h1>
<section id="id8">
<h2>üî∞ Gi·ªõi thi·ªáu:<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<p>Kh√¥ng ph·∫£i l√∫c n√†o d·ªØ li·ªáu tr√™n trang web c≈©ng ƒë∆∞·ª£c l·∫•y th√¥ng qua API.
Trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p, d·ªØ li·ªáu ƒë∆∞·ª£c render s·∫µn t·ª´ ph√≠a server (server-side rendering) v√† ch·ªâ xu·∫•t hi·ªán d∆∞·ªõi d·∫°ng HTML ƒë√£ x·ª≠ l√Ω.
Khi ƒë√≥, b·∫°n c·∫ßn hi·ªÉu v·ªÅ c·∫•u tr√∫c HTML, DOM v√† s·ª≠ d·ª•ng c√°c c√¥ng c·ª• nh∆∞ BeautifulSoup (ho·∫∑c lxml) ƒë·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ m√£ ngu·ªìn trang.</p>
<p>ƒê√¢y l√† k·ªπ nƒÉng quan tr·ªçng g·ªçi l√† web scraping, v√† th∆∞·ªùng √°p d·ª•ng trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p:</p>
<ul class="simple">
<li><p>Kh√¥ng c√≥ API c√¥ng khai</p></li>
<li><p>API b·ªã ·∫©n ho·∫∑c b·∫£o v·ªá</p></li>
<li><p>B·∫°n ch·ªâ c·∫ßn l·∫•y m·ªôt ph·∫ßn th√¥ng tin hi·ªÉn th·ªã s·∫µn tr√™n web</p></li>
</ul>
</section>
<section id="id9">
<h2>Y√™u c·∫ßu<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<section id="a-khoi-tao-trinh-duyet-va-load-du-lieu">
<h3><strong>5A.</strong> Kh·ªüi t·∫°o tr√¨nh duy·ªát v√† load d·ªØ li·ªáu<a class="headerlink" href="#a-khoi-tao-trinh-duyet-va-load-du-lieu" title="Link to this heading">#</a></h3>
<p>S·ª≠ d·ª•ng ƒë∆∞·ªùng d·∫´n sau ƒë·ªÉ l√†m vi·ªác v·ªõi danh s√°ch 200 b·ªô phim thu·ªôc th·ªÉ lo·∫°i h√†i k·ªãch (Comedy), m·ªói phim c√≥ t·ªëi thi·ªÉu 100 l∆∞·ª£t ƒë√°nh gi√°:
üîó <a class="reference external" href="https://www.imdb.com/search/title/?title_type=feature&amp;amp;num_votes=100,&amp;amp;genres=comedy&amp;amp;sort=moviemeter">https://www.imdb.com/search/title/?title_type=feature&amp;num_votes=100,&amp;genres=comedy&amp;sort=moviemeter</a></p>
<p>B·∫°n ƒë·ªçc h√£y:</p>
<ul class="simple">
<li><p>√Åp d·ª•ng th∆∞ vi·ªán Selenium ƒë·ªÉ m·ªü trang IMDb ƒë∆∞·ª£c cung c·∫•p.</p></li>
<li><p>S·ª≠ d·ª•ng thao t√°c t·ª± ƒë·ªông ƒë·ªÉ nh·∫•n n√∫t ‚ÄúLoad more‚Äù 3 l·∫ßn, gi√∫p m·ªü r·ªông danh s√°ch v√† hi·ªÉn th·ªã ƒë·ªß √≠t nh·∫•t 200 b·ªô phim.</p></li>
<li><p>Sau khi ho√†n t·∫•t thao t√°c t·∫£i th√™m n·ªôi dung, h√£y tr√≠ch xu·∫•t to√†n b·ªô m√£ HTML hi·ªán t·∫°i v√† x·ª≠ l√Ω n√≥ b·∫±ng th∆∞ vi·ªán BeautifulSoup ƒë·ªÉ chu·∫©n b·ªã cho b∆∞·ªõc tr√≠ch xu·∫•t d·ªØ li·ªáu ·ªü ph·∫ßn ti·∫øp theo.</p></li>
</ul>
</section>
<section id="b-khoi-tao-trinh-duyet-va-load-du-lieu">
<h3><strong>5B.</strong> Kh·ªüi t·∫°o tr√¨nh duy·ªát v√† load d·ªØ li·ªáu<a class="headerlink" href="#b-khoi-tao-trinh-duyet-va-load-du-lieu" title="Link to this heading">#</a></h3>
<p>T·ª´ m√£ HTML ƒë√£ t·∫£i, s·ª≠ d·ª•ng BeautifulSoup ƒë·ªÉ tr√≠ch xu·∫•t th√¥ng tin c·ªßa t·ª´ng b·ªô phim. V·ªõi m·ªói th√¥ng tin c·∫ßn l·∫•y, h√£y x√°c ƒë·ªãnh th√†nh t·ªë HTML (th·∫ª, class, thu·ªôc t√≠nh‚Ä¶) t∆∞∆°ng ·ª©ng.</p>
<ul class="simple">
<li><p>Title (T√™n phim);</p></li>
<li><p>Link (ƒê∆∞·ªùng d·∫´n IMDb);</p></li>
<li><p>Year (NƒÉm ph√°t h√†nh); Duration (Th·ªùi l∆∞·ª£ng); Age Rating (Ph√¢n lo·∫°i ƒë·ªô tu·ªïi)</p></li>
<li><p>Metascore (ƒëi·ªÉm Meta)</p></li>
<li><p>IMDb Rating (ƒêi·ªÉm IMDb)</p></li>
<li><p>IMDb Votes (gi·ªØ nguy√™n ƒë·ªãnh d·∫°ng nh∆∞ ‚Äú200K‚Äù)</p></li>
<li><p>Plot (M√¥ t·∫£ n·ªôi dung)</p></li>
</ul>
<p>K·∫øt qu·∫£ ƒë∆∞·ª£c l∆∞u v√†o m·ªôt pandas DataFrame g·ªìm 9 c·ªôt t∆∞∆°ng ·ª©ng.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install selenium,webdriver-manager, bs4</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id10">
<h2>L·ªùi gi·∫£i<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<section id="id11">
<h3><strong>5A.</strong><a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>N·∫øu d√πng c√°c ph∆∞∆°ng ph√°p th√¥ng th∆∞·ªùng nh∆∞ requests hay urllib, ta ch·ªâ l·∫•y ƒë∆∞·ª£c HTML tƒ©nh ban ƒë·∫ßu v√† kh√¥ng c√≥ ph·∫ßn n·ªôi dung t·∫£i ƒë·ªông, khi·∫øn d·ªØ li·ªáu b·ªã thi·∫øu.</p>
<p>Ngo√†i ra, IMDb c√≥ √°p d·ª•ng m·ªôt s·ªë c∆° ch·∫ø ch·ªëng bot, nh∆∞:</p>
<ul class="simple">
<li><p>Tr·∫£ v·ªÅ m√£ tr·∫°ng th√°i 202.</p></li>
<li><p>Y√™u c·∫ßu JavaScript m·ªõi hi·ªÉn th·ªã n·ªôi dung.</p></li>
<li><p>Tr·∫£ v·ªÅ th√¥ng b√°o ‚ÄúPlease enable JavaScript‚Äù n·∫øu ph√°t hi·ªán truy c·∫≠p kh√¥ng ƒë·∫øn t·ª´ tr√¨nh duy·ªát th·ª±c.</p></li>
</ul>
<p>V√¨ v·∫≠y, Selenium gi√∫p gi·∫£i quy·∫øt nh·ªØng h·∫°n ch·∫ø n√†y b·∫±ng c√°ch Gi·∫£ l·∫≠p tr√¨nh duy·ªát th·∫≠t ƒë·ªÉ th·ª±c thi JavaScript v√† T·ª± ƒë·ªông t∆∞∆°ng t√°c (nh∆∞ click n√∫t ‚ÄúLoad more‚Äù).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">selenium</span><span class="w"> </span><span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.chrome.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.common.by</span><span class="w"> </span><span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.support.ui</span><span class="w"> </span><span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.support</span><span class="w"> </span><span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">webdriver_manager.chrome</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChromeDriverManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># 1. Kh·ªüi t·∫°o tr√¨nh duy·ªát Chrome th√¥ng qua webdriver-manager</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">Service</span><span class="p">(</span><span class="n">ChromeDriverManager</span><span class="p">()</span><span class="o">.</span><span class="n">install</span><span class="p">()))</span>

<span class="c1"># 2. Truy c·∫≠p v√†o trang IMDb ch·ª©a danh s√°ch c√°c phim h√†i (comedy) c√≥ √≠t nh·∫•t 100 l∆∞·ª£t ƒë√°nh gi√°</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.imdb.com/search/title/?title_type=feature&amp;num_votes=100,&amp;genres=comedy&amp;sort=moviemeter&quot;</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># 3. T·∫°o ƒë·ªëi t∆∞·ª£ng WebDriverWait ƒë·ªÉ ch·ªù c√°c ph·∫ßn t·ª≠ xu·∫•t hi·ªán t·ªëi ƒëa 10 gi√¢y</span>
<span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># 4. T·ª± ƒë·ªông nh·∫•n n√∫t ‚ÄúLoad more‚Äù 3 l·∫ßn ƒë·ªÉ hi·ªÉn th·ªã th√™m phim (t·ªïng c·ªông √≠t nh·∫•t 200 phim)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># ƒê·ª£i m·ªôt ch√∫t ƒë·ªÉ trang ·ªïn ƒë·ªãnh tr∆∞·ªõc khi click</span>
        <span class="c1"># T√¨m n√∫t &quot;Load more&quot; v√† ƒë·ª£i cho ƒë·∫øn khi c√≥ th·ªÉ click</span>
        <span class="n">button</span> <span class="o">=</span> <span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">CSS_SELECTOR</span><span class="p">,</span> <span class="s2">&quot;button.ipc-see-more__button&quot;</span><span class="p">)))</span>
        <span class="c1"># Click n√∫t th√¥ng qua JavaScript (·ªïn ƒë·ªãnh h∆°n click tr·ª±c ti·∫øp)</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;arguments[0].click();&quot;</span><span class="p">,</span> <span class="n">button</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ Click l·∫ßn </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># N·∫øu c√≥ l·ªói (v√≠ d·ª•: kh√¥ng t√¨m th·∫•y n√∫t), in l·ªói v√† tho√°t v√≤ng l·∫∑p</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå L·ªói click l·∫ßn </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">break</span>

<span class="c1"># 5. ƒê·ª£i th√™m ƒë·ªÉ ch·∫Øc ch·∫Øn to√†n b·ªô n·ªôi dung ƒë√£ ƒë∆∞·ª£c t·∫£i</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># 6. L·∫•y to√†n b·ªô m√£ HTML c·ªßa trang sau khi ƒë√£ render b·∫±ng JavaScript</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>

<span class="c1"># 7. ƒê√≥ng tr√¨nh duy·ªát</span>
<span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>‚úÖ Click l·∫ßn 1
‚úÖ Click l·∫ßn 2
‚úÖ Click l·∫ßn 3
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h3><strong>5B.</strong><a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>B·∫°n ƒë·ªçc c√≥ th·ªÉ t√¨m th·∫•y element t∆∞∆°ng ·ª©ng v·ªõi c√°c th√¥ng tin m√¨nh c·∫ßn b·∫±ng c√°ch nh·∫•p chu·ªôt ph·∫£i -&gt; ch·ªçn inspect. C√°c th√¥ng tin t∆∞∆°ng ·ª©ng c√≥ th·ªÉ ƒë∆∞·ª£c t√¨m th·∫•y ·ªü trong c√°c element sau, t·∫•t c·∫£ c√°c th√†nh ph·∫ßn tr√™n ƒë·ªÅu n·∫±m b√™n trong th·∫ª <code class="docutils literal notranslate"><span class="pre">&lt;li</span> <span class="pre">class=&quot;ipc-metadata-list-summary-item&quot;&gt;</span></code>, m·ªói <code class="docutils literal notranslate"><span class="pre">&lt;li&gt;</span></code> ƒë·∫°i di·ªán cho m·ªôt b·ªô phim.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Th√¥ng tin</p></th>
<th class="head"><p>Th·∫ª HTML / Element ch·ª©a d·ªØ li·ªáu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>T√™n phim (<code class="docutils literal notranslate"><span class="pre">Title</span></code>)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;h3</span> <span class="pre">class=&quot;ipc-title__text&quot;&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Link IMDb (<code class="docutils literal notranslate"><span class="pre">Link</span></code>)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;a</span> <span class="pre">class=&quot;ipc-title-link-wrapper&quot;</span> <span class="pre">href=&quot;...&quot;&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>NƒÉm, th·ªùi l∆∞·ª£ng, ƒë·ªô tu·ªïi</p></td>
<td><p><strong>N·∫±m chung trong 1 d√≤ng</strong> ‚Üí <code class="docutils literal notranslate"><span class="pre">&lt;span</span> <span class="pre">class=&quot;dli-title-metadata-item&quot;&gt;</span></code> (xu·∫•t hi·ªán theo th·ª© t·ª±)</p></td>
</tr>
<tr class="row-odd"><td><p>Metascore</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;span</span> <span class="pre">class=&quot;metacritic-score-label&quot;&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>IMDb Rating</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;span</span> <span class="pre">aria-label=&quot;IMDb</span> <span class="pre">rating:</span> <span class="pre">...&quot;&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>IMDb Votes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;span</span> <span class="pre">class=&quot;ipc-rating-star--voteCount&quot;&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p>M√¥ t·∫£ phim (<code class="docutils literal notranslate"><span class="pre">Plot</span></code>)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&lt;div</span> <span class="pre">class=&quot;ipc-html-content-inner-div&quot;&gt;</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parse d·ªØ li·ªáu t·ª´ng phim t·ª´ bi·∫øn soup ƒë√£ l·∫•y ·ªü ph·∫ßn A</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># M·ªói th·∫ª &lt;li class=&quot;ipc-metadata-list-summary-item&quot;&gt; ch·ª©a th√¥ng tin c·ªßa 1 b·ªô phim</span>
<span class="k">for</span> <span class="n">li</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;li.ipc-metadata-list-summary-item&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># L·∫•y ti√™u ƒë·ªÅ phim (t√™n phim)</span>
        <span class="n">title_tag</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s2">&quot;h3.ipc-title__text&quot;</span><span class="p">)</span>

        <span class="c1"># L·∫•y th·∫ª &lt;a&gt; ch·ª©a ƒë∆∞·ªùng link IMDb</span>
        <span class="n">link_tag</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s2">&quot;a.ipc-title-link-wrapper&quot;</span><span class="p">)</span>

        <span class="c1"># L·∫•y nh√≥m c√°c th·∫ª ch·ª©a: nƒÉm, th·ªùi l∆∞·ª£ng, ƒë·ªô tu·ªïi (n·∫±m chung trong c√°c &lt;span&gt;)</span>
        <span class="n">meta_tags</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;span.dli-title-metadata-item&quot;</span><span class="p">)</span>

        <span class="c1"># Tr√≠ch xu·∫•t vƒÉn b·∫£n t·ª´ c√°c th√†nh ph·∫ßn</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title_tag</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;https://www.imdb.com&quot;</span> <span class="o">+</span> <span class="n">link_tag</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">link_tag</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Tr√≠ch xu·∫•t theo v·ªã tr√≠ n·∫øu c√≥ ƒë·ªß ph·∫ßn t·ª≠</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">meta_tags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_tags</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">meta_tags</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_tags</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">age_rating</span> <span class="o">=</span> <span class="n">meta_tags</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_tags</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># L·∫•y metascore n·∫øu c√≥</span>
        <span class="n">metascore_tag</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s2">&quot;span.metacritic-score-box&quot;</span><span class="p">)</span>
        <span class="n">metascore</span> <span class="o">=</span> <span class="n">metascore_tag</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">metascore_tag</span> <span class="k">else</span> <span class="kc">None</span>


        <span class="c1"># L·∫•y ƒëi·ªÉm IMDb t·ª´ thu·ªôc t√≠nh aria-label</span>
        <span class="n">imdb_rating_tag</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s2">&quot;span[aria-label^=&#39;IMDb rating&#39;]&quot;</span><span class="p">)</span>
        <span class="n">imdb_rating</span> <span class="o">=</span> <span class="n">imdb_rating_tag</span><span class="p">[</span><span class="s1">&#39;aria-label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">imdb_rating_tag</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># L·∫•y m√¥ t·∫£ phim (plot)</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s2">&quot;div.ipc-html-content-inner-div&quot;</span><span class="p">)</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">plot</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># L·∫•y s·ªë l∆∞·ª£ng ng∆∞·ªùi ƒë√°nh gi√° IMDb (votes), gi·ªØ nguy√™n ƒë·ªãnh d·∫°ng &quot;200K&quot;, &quot;1.5M&quot;</span>
        <span class="n">votes_tag</span> <span class="o">=</span> <span class="n">li</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;span.ipc-rating-star--voteCount&#39;</span><span class="p">)</span>
        <span class="n">votes</span> <span class="o">=</span> <span class="n">votes_tag</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot; ()</span><span class="se">\xa0</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">votes_tag</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># L∆∞u th√¥ng tin v√†o list</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;Link&quot;</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span>
            <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
            <span class="s2">&quot;Duration&quot;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
            <span class="s2">&quot;Age Rating&quot;</span><span class="p">:</span> <span class="n">age_rating</span><span class="p">,</span>
            <span class="s2">&quot;Metascore&quot;</span><span class="p">:</span> <span class="n">metascore</span><span class="p">,</span>
            <span class="s2">&quot;IMDb Rating&quot;</span><span class="p">:</span> <span class="n">imdb_rating</span><span class="p">,</span>
            <span class="s2">&quot;IMDb Votes&quot;</span><span class="p">:</span> <span class="n">votes</span><span class="p">,</span>
            <span class="s2">&quot;Plot&quot;</span><span class="p">:</span> <span class="n">plot</span>
        <span class="p">})</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># B·ªè qua n·∫øu c√≥ l·ªói x·∫£y ra ·ªü 1 phim</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ö†Ô∏è L·ªói khi x·ª≠ l√Ω phim: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

<span class="c1"># Chuy·ªÉn danh s√°ch phim th√†nh pandas DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># (Tu·ª≥ ch·ªçn) L∆∞u ra file CSV n·∫øu mu·ªën</span>
<span class="c1"># df.to_csv(&quot;IMDb_Comedy_Top200.csv&quot;, index=False)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Crawl xong 200 phim. ƒê√£ l∆∞u v√†o IMDb_Comedy_Top200.csv&quot;</span><span class="p">)</span>

<span class="c1"># Hi·ªÉn th·ªã 10 d√≤ng ƒë·∫ßu ti√™n</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>‚úÖ Crawl xong 200 phim. ƒê√£ l∆∞u v√†o IMDb_Comedy_Top200.csv
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Link</th>
      <th>Year</th>
      <th>Duration</th>
      <th>Age Rating</th>
      <th>Metascore</th>
      <th>IMDb Rating</th>
      <th>IMDb Votes</th>
      <th>Plot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1. B√≠ K√≠p Luy·ªán R·ªìng</td>
      <td>https://www.imdb.com/title/tt26743210/</td>
      <td>2025</td>
      <td>2h 5m</td>
      <td>K</td>
      <td>61</td>
      <td>8.1</td>
      <td>30K</td>
      <td>As an ancient threat endangers both Vikings an...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2. Deep Cover</td>
      <td>https://www.imdb.com/title/tt31121295/</td>
      <td>2025</td>
      <td>1h 39m</td>
      <td>R</td>
      <td>67</td>
      <td>6.7</td>
      <td>14K</td>
      <td>Three improv actors are asked to go undercover...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3. M·ªôt N·ª≠a Ho√†n H·∫£o</td>
      <td>https://www.imdb.com/title/tt30253473/</td>
      <td>2025</td>
      <td>1h 56m</td>
      <td>R</td>
      <td>71</td>
      <td>6.9</td>
      <td>7.4K</td>
      <td>A young, ambitious New York City matchmaker fi...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4. Lilo v√† Stitch</td>
      <td>https://www.imdb.com/title/tt11655566/</td>
      <td>2025</td>
      <td>1h 48m</td>
      <td>P</td>
      <td>53</td>
      <td>6.9</td>
      <td>40K</td>
      <td>A lonely Hawaiian girl befriends a runaway ali...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5. The Phoenician Scheme</td>
      <td>https://www.imdb.com/title/tt30840798/</td>
      <td>2025</td>
      <td>1h 41m</td>
      <td>PG-13</td>
      <td>69</td>
      <td>6.9</td>
      <td>17K</td>
      <td>Wealthy businessman Zsa-zsa Korda appoints his...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6. ƒê·∫°i Chi·∫øn Thi√™n H√†</td>
      <td>https://www.imdb.com/title/tt0094012/</td>
      <td>1987</td>
      <td>1h 36m</td>
      <td>PG</td>
      <td>46</td>
      <td>7.1</td>
      <td>217K</td>
      <td>A star-pilot for hire and his trusty sidekick ...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7. Mickey 17</td>
      <td>https://www.imdb.com/title/tt12299608/</td>
      <td>2025</td>
      <td>2h 17m</td>
      <td>T18</td>
      <td>72</td>
      <td>6.8</td>
      <td>159K</td>
      <td>During a human expedition to colonize space, M...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8. Eddington</td>
      <td>https://www.imdb.com/title/tt31176520/</td>
      <td>2025</td>
      <td>2h 28m</td>
      <td>R</td>
      <td>64</td>
      <td>5.9</td>
      <td>874</td>
      <td>In May of 2020, a standoff between a small-tow...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9. Nh√† H√†ng C·ªßa C√°c B√†</td>
      <td>https://www.imdb.com/title/tt28309594/</td>
      <td>2025</td>
      <td>1h 51m</td>
      <td>PG</td>
      <td>57</td>
      <td>6.9</td>
      <td>28K</td>
      <td>After losing his beloved mother, a man risks e...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10. Friendship</td>
      <td>https://www.imdb.com/title/tt30505698/</td>
      <td>2024</td>
      <td>1h 40m</td>
      <td>R</td>
      <td>72</td>
      <td>7.1</td>
      <td>11K</td>
      <td>A suburban dad falls hard for his charismatic ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ngo√†i ra, b·∫°n ƒë·ªçc c≈©ng c√≥ th·ªÉ chu·∫©n ho√° c√°c th√¥ng tin v·ªÅ duration v√† IMDb Votes ƒë·ªÉ bi·∫øn ch√∫ng v·ªÅ d·∫°ng numeric:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">parse_duration</span><span class="p">(</span><span class="n">duration_str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chuy·ªÉn &#39;2h 5m&#39; th√†nh 125 (ph√∫t).</span>
<span class="sd">    N·∫øu ch·ªâ c√≥ &#39;h&#39; ho·∫∑c &#39;m&#39;, v·∫´n x·ª≠ l√Ω ƒë∆∞·ª£c.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">duration_str</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="s1">&#39;h&#39;</span> <span class="ow">in</span> <span class="n">duration_str</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="s1">&#39;m&#39;</span> <span class="ow">in</span> <span class="n">duration_str</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">elif</span> <span class="s1">&#39;m&#39;</span> <span class="ow">in</span> <span class="n">duration_str</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">m</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_votes</span><span class="p">(</span><span class="n">vote_str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chuy·ªÉn &#39;30K&#39; ‚Üí 30000, &#39;1.5M&#39; ‚Üí 1500000</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vote_str</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">vote_str</span> <span class="o">=</span> <span class="n">vote_str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">vote_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vote_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">1_000</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">vote_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vote_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mi">1_000_000</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">vote_str</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Duration(min)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_duration</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;IMDb Votes (int)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;IMDb Votes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_votes</span><span class="p">)</span>
<span class="c1"># Lo·∫°i b·ªè s·ªë th·ª© t·ª± d·∫°ng &quot;123. &quot; ·ªü ƒë·∫ßu chu·ªói</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\d+\.\s*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Link</th>
      <th>Year</th>
      <th>Duration</th>
      <th>Age Rating</th>
      <th>Metascore</th>
      <th>IMDb Rating</th>
      <th>IMDb Votes</th>
      <th>Plot</th>
      <th>Duration(min)</th>
      <th>IMDb Votes (int)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B√≠ K√≠p Luy·ªán R·ªìng</td>
      <td>https://www.imdb.com/title/tt26743210/</td>
      <td>2025</td>
      <td>2h 5m</td>
      <td>K</td>
      <td>61</td>
      <td>8.1</td>
      <td>30K</td>
      <td>As an ancient threat endangers both Vikings an...</td>
      <td>125</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Deep Cover</td>
      <td>https://www.imdb.com/title/tt31121295/</td>
      <td>2025</td>
      <td>1h 39m</td>
      <td>R</td>
      <td>67</td>
      <td>6.7</td>
      <td>14K</td>
      <td>Three improv actors are asked to go undercover...</td>
      <td>99</td>
      <td>14000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M·ªôt N·ª≠a Ho√†n H·∫£o</td>
      <td>https://www.imdb.com/title/tt30253473/</td>
      <td>2025</td>
      <td>1h 56m</td>
      <td>R</td>
      <td>71</td>
      <td>6.9</td>
      <td>7.4K</td>
      <td>A young, ambitious New York City matchmaker fi...</td>
      <td>116</td>
      <td>7400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Lilo v√† Stitch</td>
      <td>https://www.imdb.com/title/tt11655566/</td>
      <td>2025</td>
      <td>1h 48m</td>
      <td>P</td>
      <td>53</td>
      <td>6.9</td>
      <td>40K</td>
      <td>A lonely Hawaiian girl befriends a runaway ali...</td>
      <td>108</td>
      <td>40000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Phoenician Scheme</td>
      <td>https://www.imdb.com/title/tt30840798/</td>
      <td>2025</td>
      <td>1h 41m</td>
      <td>PG-13</td>
      <td>69</td>
      <td>6.9</td>
      <td>17K</td>
      <td>Wealthy businessman Zsa-zsa Korda appoints his...</td>
      <td>101</td>
      <td>17000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ƒê·∫°i Chi·∫øn Thi√™n H√†</td>
      <td>https://www.imdb.com/title/tt0094012/</td>
      <td>1987</td>
      <td>1h 36m</td>
      <td>PG</td>
      <td>46</td>
      <td>7.1</td>
      <td>217K</td>
      <td>A star-pilot for hire and his trusty sidekick ...</td>
      <td>96</td>
      <td>217000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mickey 17</td>
      <td>https://www.imdb.com/title/tt12299608/</td>
      <td>2025</td>
      <td>2h 17m</td>
      <td>T18</td>
      <td>72</td>
      <td>6.8</td>
      <td>159K</td>
      <td>During a human expedition to colonize space, M...</td>
      <td>137</td>
      <td>159000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Eddington</td>
      <td>https://www.imdb.com/title/tt31176520/</td>
      <td>2025</td>
      <td>2h 28m</td>
      <td>R</td>
      <td>64</td>
      <td>5.9</td>
      <td>874</td>
      <td>In May of 2020, a standoff between a small-tow...</td>
      <td>148</td>
      <td>874</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Nh√† H√†ng C·ªßa C√°c B√†</td>
      <td>https://www.imdb.com/title/tt28309594/</td>
      <td>2025</td>
      <td>1h 51m</td>
      <td>PG</td>
      <td>57</td>
      <td>6.9</td>
      <td>28K</td>
      <td>After losing his beloved mother, a man risks e...</td>
      <td>111</td>
      <td>28000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Friendship</td>
      <td>https://www.imdb.com/title/tt30505698/</td>
      <td>2024</td>
      <td>1h 40m</td>
      <td>R</td>
      <td>72</td>
      <td>7.1</td>
      <td>11K</td>
      <td>A suburban dad falls hard for his charismatic ...</td>
      <td>100</td>
      <td>11000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bai-tap-6-doc-du-lieu-tu-co-so-du-lieu-sql-voi-pandas">
<h1>B√†i t·∫≠p 6: ƒê·ªçc d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu SQL v·ªõi Pandas<a class="headerlink" href="#bai-tap-6-doc-du-lieu-tu-co-so-du-lieu-sql-voi-pandas" title="Link to this heading">#</a></h1>
<section id="id13">
<h2>üî∞ Gi·ªõi thi·ªáu:<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p>SQL (Structured Query Language) l√† ng√¥n ng·ªØ ti√™u chu·∫©n d√πng ƒë·ªÉ qu·∫£n l√Ω v√† truy v·∫•n d·ªØ li·ªáu trong c√°c h·ªá qu·∫£n tr·ªã c∆° s·ªü d·ªØ li·ªáu quan h·ªá (RDBMS).
M·ªôt s·ªë h·ªá qu·∫£n tr·ªã ph·ªï bi·∫øn bao g·ªìm :</p>
<ul class="simple">
<li><p>SQLite: Nh·∫π, ƒë∆°n t·ªáp, kh√¥ng c·∫ßn server ‚Äì ph√π h·ª£p h·ªçc t·∫≠p, th·ª≠ nghi·ªám.</p></li>
<li><p>PostgreSQL: M√£ ngu·ªìn m·ªü, m·∫°nh m·∫Ω, h·ªó tr·ª£ nhi·ªÅu t√≠nh nƒÉng n√¢ng cao.</p></li>
<li><p>MySQL / MariaDB: Ph·ªï bi·∫øn trong web app, d·ªÖ tri·ªÉn khai.</p></li>
<li><p>SQL Server (Microsoft) v√† Oracle: ƒê∆∞·ª£c d√πng nhi·ªÅu trong doanh nghi·ªáp.</p></li>
</ul>
<p>Trong Python, th∆∞ vi·ªán pandas c√≥ th·ªÉ k·∫øt n·ªëi ƒë·∫øn c√°c CSDL n√†y ƒë·ªÉ:
ƒê·ªçc d·ªØ li·ªáu tr·ª±c ti·∫øp v√†o DataFrame, c≈©ng nh∆∞ th·ª±c hi·ªán truy v·∫•n SQL v√† x·ª≠ l√Ω b·∫±ng Pandas</p>
</section>
<section id="id14">
<h2>Y√™u c·∫ßu<a class="headerlink" href="#id14" title="Link to this heading">#</a></h2>
<p>Chinook l√† m·ªôt c∆° s·ªü d·ªØ li·ªáu m·∫´u m√¥ ph·ªèng h·ªá th·ªëng b√°n nh·∫°c tr·ª±c tuy·∫øn. C∆° s·ªü d·ªØ li·ªáu bao g·ªìm c√°c b·∫£ng li√™n quan ƒë·∫øn:</p>
<ul class="simple">
<li><p>Th√¥ng tin √¢m nh·∫°c: Artist, Album, Track, Genre, MediaType</p></li>
<li><p>Kh√°ch h√†ng &amp; giao d·ªãch: Customer, Invoice, InvoiceLine</p></li>
<li><p>Nh√¢n s·ª±: Employee</p></li>
<li><p>Playlist: Playlist, PlaylistTrack (b·∫£ng trung gian ƒë·ªÉ li√™n k·∫øt nhi·ªÅu b√†i h√°t v·ªõi playlist)</p></li>
</ul>
<p>B√†i t·∫≠p n√†y s·∫Ω ·ª©ng d·ª•ng CSDL tr√™n ƒë·ªÉ gi√∫p luy·ªán t·∫≠p truy v·∫•n SQL ph·ª©c t·∫°p v√† x·ª≠ l√Ω d·ªØ li·ªáu th·ª±c t·∫ø.
B·∫°n c√≥ th·ªÉ t·∫£i database n√†y theo link github d∆∞·ªõi v√† t√¨m hi·ªÉu th√™m database n√†y t·∫°i ƒë√¢y: <a class="github reference external" href="https://github.com/lerocha/chinook-database">lerocha/chinook-database</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/lerocha/chinook-database/raw/master/ChinookDatabase/DataSources/Chinook_Sqlite.sqlite&quot;</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s2">&quot;Data/Chinook.sqlite&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ ƒê√£ t·∫£i Chinook.sqlite&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>‚úÖ ƒê√£ t·∫£i Chinook.sqlite
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-thong-ke-doanh-thu-theo-quoc-gia">
<h2><strong>6A.</strong> Th·ªëng k√™ doanh thu theo qu·ªëc gia<a class="headerlink" href="#a-thong-ke-doanh-thu-theo-quoc-gia" title="Link to this heading">#</a></h2>
<p>M·ª•c ti√™u: T√¨m ra qu·ªëc gia c√≥ doanh thu l·ªõn nh·∫•t t·ª´ c√°c ƒë∆°n h√†ng.
H∆∞·ªõng d·∫´n th·ª±c hi·ªán:</p>
<ul class="simple">
<li><p>D√πng sqlite3 v√† pandas ƒë·ªÉ k·∫øt n·ªëi v√† ƒë·ªçc b·∫£ng invoices</p></li>
<li><p>Nh√≥m theo BillingCountry v√† t√≠nh t·ªïng Total</p></li>
<li><p>L·ªçc v√† hi·ªÉn th·ªã top 5 qu·ªëc gia c√≥ doanh thu cao nh·∫•t (s·∫Øp x·∫øp gi·∫£m d·∫ßn)</p></li>
</ul>
</section>
<section id="b-tinh-so-bai-hat-theo-tung-the-loai-genre">
<h2>6B. T√≠nh s·ªë b√†i h√°t theo t·ª´ng th·ªÉ lo·∫°i (Genre)<a class="headerlink" href="#b-tinh-so-bai-hat-theo-tung-the-loai-genre" title="Link to this heading">#</a></h2>
<p>M·ª•c ti√™u: ƒê·∫øm s·ªë l∆∞·ª£ng b√†i h√°t thu·ªôc t·ª´ng th·ªÉ lo·∫°i trong h·ªá th·ªëng.
H∆∞·ªõng d·∫´n th·ª±c hi·ªán:</p>
<ul class="simple">
<li><p>Truy v·∫•n b·∫£ng tracks v√† b·∫£ng genres</p></li>
<li><p>G·ªôp (merge) 2 b·∫£ng theo GenreId</p></li>
<li><p>ƒê·∫øm s·ªë l∆∞·ª£ng b√†i h√°t trong t·ª´ng GenreName, s·∫Øp x·∫øp gi·∫£m d·∫ßn</p></li>
</ul>
</section>
<section id="loi-giai-bai-tap-6">
<h2>L·ªùi gi·∫£i b√†i t·∫≠p 6<a class="headerlink" href="#loi-giai-bai-tap-6" title="Link to this heading">#</a></h2>
</section>
<section id="id15">
<h2><strong>6A.</strong><a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandasql</span><span class="o">,</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="o">,</span><span class="nn">sqlite3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># B∆∞·ªõc 1: K·∫øt n·ªëi t·ªõi c∆° s·ªü d·ªØ li·ªáu Chinook</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Data/Chinook.sqlite&#39;</span><span class="p">)</span>

<span class="c1"># B∆∞·ªõc 2: ƒê·ªçc b·∫£ng invoices</span>
<span class="n">Invoice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Invoice&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>

<span class="c1"># B∆∞·ªõc 3: Nh√≥m theo qu·ªëc gia v√† t√≠nh t·ªïng doanh thu</span>
<span class="n">revenue_by_country</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Invoice</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;BillingCountry&quot;</span><span class="p">)[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;BillingCountry&quot;</span><span class="p">:</span> <span class="s2">&quot;Country&quot;</span><span class="p">,</span> <span class="s2">&quot;Total&quot;</span><span class="p">:</span> <span class="s2">&quot;TotalRevenue&quot;</span><span class="p">})</span>
<span class="p">)</span>

<span class="c1"># B∆∞·ªõc 4: S·∫Øp x·∫øp gi·∫£m d·∫ßn v√† l·∫•y top 5 qu·ªëc gia c√≥ doanh thu cao nh·∫•t</span>
<span class="n">top_countries</span> <span class="o">=</span> <span class="n">revenue_by_country</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TotalRevenue&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Hi·ªÉn th·ªã k·∫øt qu·∫£</span>
<span class="n">top_countries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>TotalRevenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>USA</td>
      <td>523.06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Canada</td>
      <td>303.96</td>
    </tr>
    <tr>
      <th>10</th>
      <td>France</td>
      <td>195.10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brazil</td>
      <td>190.10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Germany</td>
      <td>156.48</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id16">
<h2>6B<a class="headerlink" href="#id16" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># 1. K·∫øt n·ªëi t·ªõi database, ƒë√£ k·∫øt n·ªëi ·ªü ph·∫ßn 5A</span>
<span class="c1">#conn = sqlite3.connect(&quot;Chinook.sqlite&quot;)</span>

<span class="c1"># 2. ƒê·ªçc b·∫£ng Track v√† Genre</span>
<span class="n">df_track</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Track&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df_genre</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM Genre&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>

<span class="c1"># 3. G·ªôp theo GenreId</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_track</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_genre</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;GenreId&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

<span class="c1"># 4. ƒê·ªïi t√™n c·ªôt r√µ r√†ng</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;Name_x&quot;</span><span class="p">:</span> <span class="s2">&quot;TrackName&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Name_y&quot;</span><span class="p">:</span> <span class="s2">&quot;GenreName&quot;</span>
<span class="p">})</span>

<span class="c1"># 5. ƒê·∫øm s·ªë l∆∞·ª£ng b√†i h√°t theo th·ªÉ lo·∫°i</span>
<span class="n">genre_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;GenreName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">genre_counts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;GenreName&quot;</span><span class="p">,</span> <span class="s2">&quot;TrackCount&quot;</span><span class="p">]</span>

<span class="c1"># 6. Hi·ªÉn th·ªã k·∫øt qu·∫£</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genre_counts</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            GenreName  TrackCount
0                Rock        1297
1               Latin         579
2               Metal         374
3  Alternative &amp; Punk         332
4                Jazz         130
5            TV Shows          93
6               Blues          81
7           Classical          74
8               Drama          64
9            R&amp;B/Soul          61
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./practice-exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="30_bai_tap_pandas.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">B√†i t·∫≠p tr·ª±c quan h√≥a d·ªØ li·ªáu</p>
      </div>
    </a>
    <a class="right-next"
       href="50_bai_tap_tien_xu_ly_du_lieu.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Th·ª±c h√†nh nh·∫≠p li·ªáu t·ª´ c√°c ngu·ªìn kh√°c nhau</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-1-doc-file-tu-file-delimited-data">B√†i t·∫≠p 1: ƒê·ªçc file T·ª´ file delimited data:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gioi-thieu">üî∞ Gi·ªõi thi·ªáu:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-doc-file-delimited-data"><strong>1A.</strong> ƒê·ªçc file Delimited data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-gop-files"><strong>1B.</strong> G·ªôp files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai-bai-tap-1">L·ªùi gi·∫£i b√†i t·∫≠p 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a"><strong>1A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b"><strong>1B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-2-doc-du-lieu-tu-tu-file-excel">B√†i t·∫≠p 2: ƒê·ªçc d·ªØ li·ªáu t·ª´ T·ª´ File excel</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-3-tu-file-hoac-object-json">B√†i t·∫≠p 3: T·ª´ file ho·∫∑c object json:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#yeu-cau">Y√™u c·∫ßu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai-bai-tap-3">L·ªùi gi·∫£i b√†i t·∫≠p 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>3A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>3B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-4-lay-du-lieu-tu-api">B√†i t·∫≠p 4: L·∫•y d·ªØ li·ªáu t·ª´ API</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Y√™u c·∫ßu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-tim-api-du-lieu-bang-gia-khop-lenh-vn30"><strong>4A.</strong> T√¨m API d·ªØ li·ªáu b·∫£ng gi√° kh·ªõp l·ªánh VN30</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-tai-tao-du-lieu"><strong>4B.</strong> T√°i t·∫°o d·ªØ li·ªáu</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai">L·ªùi gi·∫£i</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>4A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>4B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-5-lay-du-lieu-tu-trang-web-khong-qua-api">B√†i t·∫≠p 5: L·∫•y d·ªØ li·ªáu t·ª´ trang web (kh√¥ng qua API)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Y√™u c·∫ßu</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-khoi-tao-trinh-duyet-va-load-du-lieu"><strong>5A.</strong> Kh·ªüi t·∫°o tr√¨nh duy·ªát v√† load d·ªØ li·ªáu</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-khoi-tao-trinh-duyet-va-load-du-lieu"><strong>5B.</strong> Kh·ªüi t·∫°o tr√¨nh duy·ªát v√† load d·ªØ li·ªáu</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">L·ªùi gi·∫£i</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>5A.</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>5B.</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bai-tap-6-doc-du-lieu-tu-co-so-du-lieu-sql-voi-pandas">B√†i t·∫≠p 6: ƒê·ªçc d·ªØ li·ªáu t·ª´ c∆° s·ªü d·ªØ li·ªáu SQL v·ªõi Pandas</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">üî∞ Gi·ªõi thi·ªáu:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Y√™u c·∫ßu</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-thong-ke-doanh-thu-theo-quoc-gia"><strong>6A.</strong> Th·ªëng k√™ doanh thu theo qu·ªëc gia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-tinh-so-bai-hat-theo-tung-the-loai-genre">6B. T√≠nh s·ªë b√†i h√°t theo t·ª´ng th·ªÉ lo·∫°i (Genre)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loi-giai-bai-tap-6">L·ªùi gi·∫£i b√†i t·∫≠p 6</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><strong>6A.</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">6B</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tr∆∞·ªùng C√¥ng ngh·ªá, ƒê·∫°i h·ªçc Kinh t·∫ø Qu·ªëc d√¢n
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>